**异常&信号&中断**
中断和异常可以归结为一种事件处理机制，通过中断或异常发出一个信号，然后操作系统会打断当前的操作，然后根据信号找到对应的处理程序处理这个中断或异常，处理完毕之后再根据处理结果是否要返回到原程序接着往下执行。
![](../images/中断示例.png)
`中断`由硬件设备生成。
`异常`是一个同步的事件，通常由程序的错误产生的，或是由内核必须处理的异常条件产生的。
`信号`是一种软件形式的异常。
**上下文切换**
系统调用上下文切换
CPU 寄存器里原来的指令位置是在用户态。但是为了执行内核态代码，需要先把用户态的位置保存起来，然后寄存器更新为内核态指令的新位置。最后跳转到内核态运行内核任务。当系统调用结束后，CPU 寄存器需要恢复原来保存的用户态位置，然后再切换到用户空间，继续运行进程。一次系统调用会产生两次 CPU 上下文切换。
进程上下文切换
内核通过调度器（scheduler）来控制当前进程是否可以被抢占，如果被抢占那么内核会选择一个新的进程运行，将旧进程的上下文保存起来，并恢复新进程的上下文，然后将控制转交给新进程，这就是上下文切换。
![](../images/进程上下文切换示例.png)
上图展示的是 A 和 B 进程之间切换的示例。进程 A 初始在用户模式中，直到它通过执行系统调用 read 进入到内核，因为磁盘读取数据需要一定时间，所以内核执行进程 A 到 B 的切换。随后磁盘数据 ready 之后磁盘控制器会发出一个中断信号，表示数据已经从磁盘传送到了内存，那么内核会从内核 B 切换到 A ，并接着执行进程 A 中紧随在系统调用 read 之后的那条指令。