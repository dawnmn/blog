**at定时任务**
```
at 23:59 12/31/2018
# 输入命令内容
php /path/task.php
# 保存
ctrl+d
 
# 查看
atq
# 删除
atrm 1
```

**crontab计划任务**
```
# 帮助文档
cat /etc/crontab

# 查看已有计划任务
crontab -l
 
#编辑计划任务
crontab -e
 
# 使用全路径 采用超时控制+锁机制，解决两个连续任务同时运行的问题
timeout -s SIGINT 100 flock -xn /var/lock /usr/local/php/bin/php /path/task.php
 
#重新载入任务列表
service crond reload

#安装
yum install vixie-cron
yum install crontabs
service crond start
```
**timeout超时命令**
`timeout [OPTION] DURATION COMMAND [ARG]...`
时间单位：`s` 秒 `m` 分钟 `h` 小时 `d` 天

`-s`：`--signal`，指定在超时时发送的信号，查看`kill -l`以获得信号列表。

使用示例：
```
timeout -s SIGKILL 1m curl http://192.168.2.70:9080/#/admin-page
```
**flock**
`flock [options] <file|directory> <command> [command args]`

它的第一个参数是文件描述符，在此文件描述符关闭时，锁会自动释放。而当进程终止时，所有的文件描述符均会被关闭。
`-s` 共享锁，默认阻塞 `-x` 独占锁（默认），默认阻塞 `-n` 非阻塞，如果无法立即获取锁，则立即退出 `-w` 等待锁超时，单位秒
使用示例：


```
flock /tmp/a.lock sleep 10
```

查看系统当前存在的锁
```
lslocks|grep FLOCK
```
